
#include <mega16.h>
#include <delay.h>

flash unsigned char image_code[64]=
{
    0x00,    //    0001        . . . . . . . . 
    0x00,    //    0002        . . . . . . . . 
    0x00,    //    0003        . . . . . . . . 
    0x00,    //    0004        . . . . . . . . 
    0x00,    //    0005        . . . . . . . . 
    0x00,    //    0006        . . . . . . . . 
    0x00,    //    0007        . . . . . . . . 
    0x00,    //    0008        . . . . . . . . 
    0x00,    //    0009        . . . . . . . . 
    0x00,    //    000A        . . . . . . . . 
    0x00,    //    000B        . . . . . . . . 
    0x00,    //    000C        . . . . . . . . 
    0x00,    //    000D        . . . . . . . . 
    0x00,    //    000E        . . . . . . . . 
    0x1C,    //    000F        . . . # # # . . 
    0x20,    //    0010        . . # . . . . . 
    0x20,    //    0011        . . # . . . . . 
    0x20,    //    0012        . . # . . . . . 
    0x22,    //    0013        . . # . . . # . 
    0x25,    //    0014        . . # . . # . # 
    0x29,    //    0015        . . # . # . . # 
    0x1A,    //    0016        . . . # # . # . 
    0x00,    //    0017        . . . . . . . . 
    0x20,    //    0018        . . # . . . . . 
    0x20,    //    0019        . . # . . . . . 
    0x22,    //    001A        . . # . . . # . 
    0x24,    //    001B        . . # . . # . . 
    0x18,    //    001C        . . . # # . . . 
    0x20,    //    001D        . . # . . . . . 
    0x20,    //    001E        . . # . . . . . 
    0xFC,    //    001F        # # # # # # . . 
    0x52,    //    0020        . # . # . . # . 
    0x4C,    //    0021        . # . . # # . . 
    0x20,    //    0022        . . # . . . . . 
    0x20,    //    0023        . . # . . . . . 
    0x20,    //    0024        . . # . . . . . 
    0x1C,    //    0025        . . . # # # . . 
    0x22,    //    0026        . . # . . . # . 
    0x22,    //    0027        . . # . . . # . 
    0x1C,    //    0028        . . . # # # . . 
    0x00,    //    0029        . . . . . . . . 
    0x00,    //    002A        . . . . . . . . 
    0x00,    //    002B        . . . . . . . . 
    0x00,    //    002C        . . . . . . . . 
    0x00,    //    002D        . . . . . . . . 
    0x3F,    //    002E        . . # # # # # # 
    0x20,    //    002F        . . # . . . . . 
    0xA0,    //    0030        # . # . . . . . 
    0x20,    //    0031        . . # . . . . . 
    0x9C,    //    0032        # . . # # # . . 
    0x00,    //    0033        . . . . . . . . 
    0x00,    //    0034        . . . . . . . . 
    0x00,    //    0035        . . . . . . . . 
    0x00,    //    0036        . . . . . . . . 
    0x00,    //    0037        . . . . . . . . 
    0x00,    //    0038        . . . . . . . . 
    0x00,    //    0039        . . . . . . . . 
    0x00,    //    003A        . . . . . . . . 
    0x00,    //    003B        . . . . . . . . 
    0x00,    //    003C        . . . . . . . . 
    0x00,    //    003D        . . . . . . . . 
    0x00,    //    003E        . . . . . . . . 
    0x00,    //    003F            . . . . . . . . 
    0x00,     //    0040		. . . . . . . . 
};


void main(void)
{
 char    X=1,i=0,j=56,f=0,maxf=50;
DDRC = 0xFF;
DDRD = 0xFF;

DDRA=(0<<DDA7) | (0<<DDA6) | (0<<DDA5) | (0<<DDA4) | (0<<DDA3) | (0<<DDA2) | (0<<DDA1) | (0<<DDA0);

PORTA=(0<<PORTA7) | (0<<PORTA6) | (0<<PORTA5) | (0<<PORTA4) | (0<<PORTA3) | (0<<PORTA2) | (0<<PORTA1) | (0<<PORTA0);


DDRB=(0<<DDB7) | (0<<DDB6) | (0<<DDB5) | (0<<DDB4) | (0<<DDB3) | (0<<DDB2) | (0<<DDB1) | (0<<DDB0);

PORTB=(0<<PORTB7) | (0<<PORTB6) | (0<<PORTB5) | (0<<PORTB4) | (0<<PORTB3) | (0<<PORTB2) | (0<<PORTB1) | (0<<PORTB0);

DDRC=(1<<DDC7) | (1<<DDC6) | (1<<DDC5) | (1<<DDC4) | (1<<DDC3) | (1<<DDC2) | (1<<DDC1) | (1<<DDC0);

PORTC=(0<<PORTC7) | (0<<PORTC6) | (0<<PORTC5) | (0<<PORTC4) | (0<<PORTC3) | (0<<PORTC2) | (0<<PORTC1) | (0<<PORTC0);


DDRD=(1<<DDD7) | (1<<DDD6) | (1<<DDD5) | (1<<DDD4) | (1<<DDD3) | (1<<DDD2) | (1<<DDD1) | (1<<DDD0);

PORTD=(0<<PORTD7) | (0<<PORTD6) | (0<<PORTD5) | (0<<PORTD4) | (0<<PORTD3) | (0<<PORTD2) | (0<<PORTD1) | (0<<PORTD0);


TCCR0=(0<<WGM00) | (0<<COM01) | (0<<COM00) | (0<<WGM01) | (0<<CS02) | (0<<CS01) | (0<<CS00);
TCNT0=0x00;
OCR0=0x00;


TCCR1A=(0<<COM1A1) | (0<<COM1A0) | (0<<COM1B1) | (0<<COM1B0) | (0<<WGM11) | (0<<WGM10);
TCCR1B=(0<<ICNC1) | (0<<ICES1) | (0<<WGM13) | (0<<WGM12) | (0<<CS12) | (0<<CS11) | (0<<CS10);
TCNT1H=0x00;
TCNT1L=0x00;
ICR1H=0x00;
ICR1L=0x00;
OCR1AH=0x00;
OCR1AL=0x00;
OCR1BH=0x00;
OCR1BL=0x00;


ASSR=0<<AS2;
TCCR2=(0<<PWM2) | (0<<COM21) | (0<<COM20) | (0<<CTC2) | (0<<CS22) | (0<<CS21) | (0<<CS20);
TCNT2=0x00;
OCR2=0x00;

TIMSK=(0<<OCIE2) | (0<<TOIE2) | (0<<TICIE1) | (0<<OCIE1A) | (0<<OCIE1B) | (0<<TOIE1) | (0<<OCIE0) | (0<<TOIE0);


MCUCR=(0<<ISC11) | (0<<ISC10) | (0<<ISC01) | (0<<ISC00);
MCUCSR=(0<<ISC2);

UCSRB=(0<<RXCIE) | (0<<TXCIE) | (0<<UDRIE) | (0<<RXEN) | (0<<TXEN) | (0<<UCSZ2) | (0<<RXB8) | (0<<TXB8);

ACSR=(1<<ACD) | (0<<ACBG) | (0<<ACO) | (0<<ACI) | (0<<ACIE) | (0<<ACIC) | (0<<ACIS1) | (0<<ACIS0);
SFIOR=(0<<ACME);


ADCSRA=(0<<ADEN) | (0<<ADSC) | (0<<ADATE) | (0<<ADIF) | (0<<ADIE) | (0<<ADPS2) | (0<<ADPS1) | (0<<ADPS0);

SPCR=(0<<SPIE) | (0<<SPE) | (0<<DORD) | (0<<MSTR) | (0<<CPOL) | (0<<CPHA) | (0<<SPR1) | (0<<SPR0);


TWCR=(0<<TWEA) | (0<<TWSTA) | (0<<TWSTO) | (0<<TWEN) | (0<<TWIE);

while (1)
      {
      
    for(f=0;f<maxf;f++){
        X=1;
        for(i=0;i<8;i++){ 
            PORTD = ~X;  
            X=X<<1;
            PORTC =  image_code[7-i+j];
            delay_us(800);
        }
        if(PINA.0 == 1){ 
            PORTD=0xFF;
            while(PINA.0 == 1);
            if(maxf<100)
                maxf+=10;
       
        }               
        }
        if(j==0)
            j=57;
        j--;
        
      }
}
      


